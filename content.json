[{"title":"内存快照获取与分析","date":"2020-03-08T05:41:49.088Z","path":"2020/03/08/EclipseMemoryAnalyzer/","text":"获取DUMP快照 参考 启动参数配置OOM时触发打印堆快照1.tomcat启动方式添加参数123(添加环境变量) export JAVA_OPTS= -XX:+HeapDumpOnOutOfMemoryError (表明进行统计相关heapDump文件再OOM的时候)-XX:HeapDumpPath=/export/Domains/rcsv-fm.wd.local/server1/logs/gc.hprof（表明会导出生产的HeapDump文件的路径） 2.jvm 命令参数123456 (添加环境变量) Java -jar -XX:+HeapDumpOnOutOfMemoryError (表明进行统计相关heapDump文件再OOM的时候) -XX:HeapDumpPath=/export/Domains/rcsv-fm.wd.local/server1/logs/gc.hprof（表明会导出生产的HeapDump文件的路径） （1）-XX:+HeapDumpOnOutOfMemoryError参数表示当JVM发生OOM时，自动生成DUMP文件。（2）-XX:HeapDumpPath=$&#123;目录&#125;参数表示生成DUMP文件的路径，也可以指定文件名称，例如：-XX:HeapDumpPath=$&#123;目录&#125;/java_heapdump.hprof。如果不指定文件名，默认为：java_&lt;pid&gt;_&lt;date&gt;_&lt;time&gt;_heapDump.hprof。 启动参数配置OOM时触发打印堆快照 启动参数配置OOM时触发打印堆快照123456789101112131415161718192021 jmap -dump:format=b,file=xxx.hprof pid jmap -dump:format=b,file=/path/heap.bin 进程ID 如果只dump heap中的存活对象，则加上选项-live。 kill -3 or -9 都不会打堆快照，kill jvm来不及做任何事情就被干掉了，-3会打印thread dump 但是不是heap dump。 ps -ef|grep tomcat #获取tomcat的pid/jps -lv -XX:+PrintGCDetails -Xloggc:/opt/logs/gc.log -verbose:gc jmap -histo:live pid&gt;a.log``` ## Eclipse Memory Analyzer### 1.安装##### 下载地址：https://www.eclipse.org/mat/downloads.php##### 修改初始化参数 MemoryAnalyzer.ini``` bash-startup../Eclipse/plugins/org.eclipse.equinox.launcher_1.5.0.v20180512-1130.jar--launcher.library../Eclipse/plugins/org.eclipse.equinox.launcher.cocoa.macosx.x86_64_1.1.700.v20180518-1200-vmargs-Xmx4024m -Dorg.eclipse.swt.internal.carbon.smallFonts-XstartOnFirstThread 2.分析","slug":"EclipseMemoryAnalyzer","updated":"2020-03-08T05:41:49.088Z","comments":true,"categories":[],"tags":[]},{"title":"Hello World","date":"2019-11-02T11:23:28.823Z","path":"2019/11/02/hello-world/","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","slug":"hello-world","updated":"2019-11-02T11:23:28.823Z","comments":true,"categories":[],"tags":[]}]